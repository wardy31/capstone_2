{"ast":null,"code":"import { mapState } from \"vuex\";\nimport moment from \"moment\";\nimport jspdf from \"jspdf\";\nimport autoTable from \"jspdf-autotable\";\nexport default {\n  mounted() {\n    this.$store.dispatch(\"generates/getPatient\");\n    this.$store.dispatch(\"disease/getData\");\n    this.$store.dispatch(\"generates/submittedResponse\");\n    this.$store.dispatch(\"generates/getTaggeds\");\n  },\n  filters: {\n    filterDate(val) {\n      return moment(val).format(\"MMM. DD, YYYY\").toString();\n    },\n    filterTime(val) {\n      return moment(val).format(\"hh:mm a\").toString();\n    }\n  },\n  computed: {\n    ...mapState({\n      diseases: state => state.disease.all.data,\n      contacts: state => state.generates.all.data,\n      records: state => state.generates.submit.data,\n      taggeds: state => state.generates.taggeds.data\n    })\n  },\n  data() {\n    return {\n      form_answers: [],\n      form_dialog: false,\n      disease_id: null,\n      date: \"\",\n      closeContact: {\n        disease_id: null,\n        date: \"\",\n        menu: false\n      },\n      hdr: {\n        date: \"\",\n        menu: false\n      },\n      page: 1,\n      menu: false\n    };\n  },\n  methods: {\n    handleQuestion(data) {\n      console.log(data.split(\",\"));\n      if (data.trim()) {\n        const arr = data.split(\",\");\n        return arr;\n      }\n      return [];\n    },\n    handleFormDialog(data) {\n      this.form_answers = data;\n      this.form_dialog = true;\n    },\n    handleDate(data) {\n      console.log(data);\n      this.$store.dispatch(\"generates/getDatePatient\", {\n        date: data\n      });\n      this.menu = false;\n    },\n    handleCloseContactDate(data) {\n      console.log(data);\n      this.$store.dispatch(\"generates/getDateTaggeds\", {\n        date: data\n      });\n      this.closeContact.menu = false;\n    },\n    handleHdrDate(data) {\n      console.log(data);\n      this.$store.dispatch(\"generates/dateResponse\", {\n        date: data\n      });\n      this.hdr[\"menu\"] = false;\n    },\n    handleCloseContactSelect(data) {\n      console.log(\"cc\", data);\n      if (this.closeContact[\"date\"]) {\n        this.$store.dispatch(\"generates/getDateTaggeds\", {\n          date: this.closeContact.date,\n          disease_id: data\n        });\n        return;\n      }\n      this.$store.dispatch(\"generates/getDateTaggeds\", {\n        disease_id: data\n      });\n    },\n    handleSelect(data) {\n      console.log(data);\n      if (this.date) {\n        this.$store.dispatch(\"generates/getDatePatient\", {\n          date: this.date,\n          disease_id: data\n        });\n        return;\n      }\n      this.$store.dispatch(\"generates/getDatePatient\", {\n        disease_id: data\n      });\n    },\n    // Generete Pdf Buttons\n    downloadPatient() {\n      const pdf = new jspdf();\n      const msg = \"Generated Reports\";\n      const content = \"Patient with Close Contacts\";\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 15, msg);\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 22, content);\n\n      // let crement = 0\n\n      for (const i of this.contacts) {\n        // crement +=1\n        // pdf.setFontSize(11);\n        // pdf.setFont(\"courier\");\n        // pdf.text(15 , 38 + crement, `${i.user_account.first_name.toUpperCase()} ${i.user_account?.middle_name ? i.user_account?.middle_name.toUpperCase() : \" \"} ${i.user_account?.last_name.toUpperCase()}`);\n\n        // pdf.setFontSize(11);\n        // pdf.setFont(\"courier\");\n        // pdf.text(15 , 40 + crement, `Created At: ${moment(i.created_at).format(\"MMM. DD, YYYY\").toString()}`);\n        // pdf.text(120, 40 + crement, `Disease Type : ${i.disease.name}`);\n\n        const newMap = i.contacts.map(m => {\n          console.log(\"enter\", m);\n          return {\n            patient: `${m.user_patient.user_account?.first_name.toUpperCase()} ${m.user_patient.user_account?.middle_name.toUpperCase()} ${m.user_patient.user_account?.last_name.toUpperCase()} \\n ${m.user_patient.user_account.classification?.name}`,\n            name: `${m.user_tagged.user_account.first_name.toUpperCase()} ${m.user_tagged.user_account?.middle_name ? m.user_tagged.user_account.middle_name.toUpperCase() : \" \"} ${m.user_tagged.user_account.last_name.toUpperCase()} \\n ${m.user_tagged.user_account.classification.name}`,\n            disease_type: m.user_tagged.disease.name,\n            created_at: moment(m.user_tagged.created_at).format(\"MMM. DD, YYYY\").toString()\n          };\n        });\n        autoTable(pdf, {\n          headStyles: {\n            fillColor: \"#141E61\",\n            font: \"courier\",\n            fontStyle: \"bold\"\n          },\n          columnStyles: {\n            name: {\n              font: \"courier\",\n              valign: \"middle\"\n            },\n            disease_type: {\n              font: \"courier\"\n            },\n            created_at: {\n              font: \"courier\"\n            }\n          },\n          margin: {\n            top: 45\n          },\n          columns: [{\n            header: \"Patient Name\",\n            dataKey: \"patient\"\n          }, {\n            header: \"Close Contacted\",\n            dataKey: \"name\"\n          }, {\n            header: \"Disease Type\",\n            dataKey: \"disease_type\"\n          }, {\n            header: \"Created At\",\n            dataKey: \"created_at\"\n          }],\n          body: newMap\n        });\n      }\n      if (this.date.trim() == \"\" && this.disease_id) {\n        const find = this.diseases.find(f => f.id == this.disease_id);\n        pdf.save(`${find.name}-patient-with-close-contacts.pdf`);\n      } else if (this.date && !this.disease_id) {\n        pdf.save(`${this.date}-patient-with-close-contacts.pdf`);\n      } else if (this.date && this.disease_id) {\n        const find = this.diseases.find(f => f.id == this.disease_id);\n        pdf.save(`${this.date}-${find.name}-patient-with-close-contacts.pdf`);\n      } else {\n        pdf.save(`all-patient-with-close-contacts.pdf`);\n      }\n    },\n    downloadCloseContacts() {\n      const newMap = this.taggeds.map(m => {\n        return {\n          name: `${m.user_account.first_name.toUpperCase()} ${m.user_account?.middle_name ? m.user_account.middle_name.toUpperCase() : \" \"} ${m.user_account.last_name.toUpperCase()} \\t ${m.user_account.classification.name}`,\n          contact_with: `${m.contact_with?.user_patient?.user_account.first_name.toUpperCase()} ${m.contact_with?.user_patient?.user_account?.middle_name ? m.contact_with?.user_patient?.user_account.middle_name.toUpperCase() : \" \"} ${m.contact_with?.user_patient?.user_account.last_name.toUpperCase()} \\t ${m.user_account.classification.name}`,\n          disease_type: m.disease.name,\n          created_at: moment(m.created_at).format(\"MMM. DD, YYYY\").toString()\n        };\n      });\n      const pdf = new jspdf();\n      const msg = \"Generated Reports\";\n      const content = \"Classified Close Contacts\";\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 15, msg);\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 22, content);\n      autoTable(pdf, {\n        headStyles: {\n          fillColor: \"#141E61\"\n        },\n        margin: {\n          top: 45\n        },\n        columns: [{\n          header: \"Name\",\n          dataKey: \"name\"\n        }, {\n          header: \"Contact With\",\n          dataKey: \"contact_with\"\n        }, {\n          header: \"Disease Type\",\n          dataKey: \"disease_type\"\n        }, {\n          header: \"Created At\",\n          dataKey: \"created_at\"\n        }],\n        body: newMap\n      });\n      if (this.closeContact.date.trim() == \"\" && this.closeContact.disease_id) {\n        const find = this.diseases.find(f => f.id == this.closeContact.disease_id);\n        pdf.save(`${find.name}-classified-close-contacts.pdf`);\n      } else if (this.closeContact.date && !this.closeContact.disease_id) {\n        pdf.save(`${this.closeContact.date}-classified-close-contacts.pdf`);\n      } else if (this.closeContact[\"date\"] && this.closeContact.disease_id) {\n        const find = this.diseases.find(f => f.id == this.closeContact.disease_id);\n        pdf.save(`${this.closeContact[\"date\"]}-${find.name}-classified-close-contacts.pdf`);\n      } else {\n        pdf.save(`all-classified-close-contacts.pdf`);\n      }\n    },\n    downloadHDR() {\n      const newMap = this.records.map(m => {\n        let num = 0;\n        const obj = {};\n        for (const key of m.answers) {\n          num += 1;\n          obj[`Question No. ${num}`] = key.answer ? \"True\" : \"False\";\n        }\n        obj[\"time\"] = moment(m.created_at).format(\"hh:mm a\").toString();\n        obj[\"date\"] = moment(m.created_at).format(\"MMM. DD, YYYY\").toString();\n        obj[\"name\"] = `${m.user_account.first_name.toUpperCase()} ${m.user_account?.middle_name ? m.user_account.middle_name.toUpperCase() : \" \"} ${m.user_account.last_name.toUpperCase()}`;\n        return obj;\n      });\n      let numColumns = -1;\n      const columns = [];\n      if (newMap.length) {\n        for (const key of Object.keys(newMap[0]).reverse()) {\n          numColumns += 1;\n          columns[numColumns] = {\n            header: key.toString().toUpperCase(),\n            dataKey: key\n          };\n        }\n      }\n      const pdf = new jspdf();\n      const msg = \"Generated Reports\";\n      const content = \"Health Declaration Responses\";\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 15, msg);\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 22, content);\n      autoTable(pdf, {\n        headStyles: {\n          fillColor: \"#141E61\"\n        },\n        margin: {\n          top: 45\n        },\n        columns: columns,\n        body: newMap.reverse()\n      });\n      if (this.hdr.date.trim() == \"\") {\n        pdf.save(\"All-HDR.pdf\");\n        return;\n      }\n      pdf.save(`${this.hdr.date}-HD.pdf`);\n    }\n  }\n};","map":{"version":3,"mappings":"AAuWA;AACA;AACA;AACA;AACA;EACAA;IACA;IACA;IACA;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;QACAF;QACAC;QACAE;MACA;MACAC;QACAH;QACAE;MACA;MACAE;MACAF;IACA;EACA;EACAG;IACAC;MACAC;MACA;QACA;QACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACAF;MACA;QAAAP;MAAA;MACA;IACA;IACAU;MACAH;MACA;QAAAP;MAAA;MACA;IACA;IACAW;MACAJ;MACA;QAAAP;MAAA;MACA;IACA;IACAY;MACAL;MACA;QACA;UACAP;UACAD;QACA;QACA;MACA;MACA;QAAAA;MAAA;IACA;IACAc;MACAN;MACA;QACA;UACAP;UACAD;QACA;QACA;MACA;MACA;QAAAA;MAAA;IACA;IACA;IACAe;MACA;MACA;MACA;MAEAC;MACAA;MACAA;MAEAA;MACAA;MACAA;;MAEA;;MAEA;QACA;QACA;QACA;QACA;;QAEA;QACA;QACA;QACA;;QAEA;UACAR;UACA;YACAS,0LACAC,gDACA;YACAC,gEACAD,0CACAA,uDACA,GACA,6DACAA,8CACA;YACAE;YACAC,6CACAC,wBACAC;UACA;QACA;QAEAC;UACAC;YACAC;YACAC;YACAC;UACA;UACAC;YACAV;cAAAQ;cAAAG;YAAA;YACAV;cAAAO;YAAA;YACAN;cAAAM;YAAA;UACA;UACAI;YACAC;UACA;UACAC,UACA;YAAAC;YAAAC;UAAA,GACA;YAAAD;YAAAC;UAAA,GACA;YAAAD;YAAAC;UAAA,GACA;YAAAD;YAAAC;UAAA,EACA;UACAC;QACA;MACA;MAEA;QACA;QACApB;MACA;QACAA;MACA;QACA;QACAA;MACA;QACAA;MACA;IACA;IAEAqB;MACA;QACA;UACAlB,oDACAD,8BACAA,2CACA,GACA,iDACAA,kCACA;UACAoB,wFACApB,0DACAA,uEACA,GACA,6EACAA,kCACA;UACAE;UACAC;QACA;MACA;MAEA;MACA;MACA;MAEAL;MACAA;MACAA;MAEAA;MACAA;MACAA;MAEAQ;QACAC;UAAAC;QAAA;QACAK;UACAC;QACA;QACAC,UACA;UAAAC;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,GACA;UAAAD;UAAAC;QAAA,EACA;QACAC;MACA;MAEA;QACA,gCACAG,0CACA;QACAvB;MACA;QACAA;MACA;QACA,gCACAuB,0CACA;QACAvB,SACA,0EACA;MACA;QACAA;MACA;IACA;IACAwB;MACA;QACA;QACA;QAEA;UACAC;UACAC;QACA;QACAA;QACAA;QACAA,4DACAxB,8BACAA,2CACA,GACA;QACA;MACA;MAEA;MACA;MAEA;QACA;UACAyB;UACAV;YACAC;YACAC;UACA;QACA;MACA;MAEA;MACA;MACA;MAEAnB;MACAA;MACAA;MAEAA;MACAA;MACAA;MAEAQ;QACAC;UAAAC;QAAA;QACAK;UACAC;QACA;QACAC;QACAG;MACA;MAEA;QACApB;QACA;MACA;MAEAA;IACA;EACA;AACA","names":["mounted","filters","filterDate","filterTime","computed","diseases","contacts","records","taggeds","data","form_answers","form_dialog","disease_id","date","closeContact","menu","hdr","page","methods","handleQuestion","console","handleFormDialog","handleDate","handleCloseContactDate","handleHdrDate","handleCloseContactSelect","handleSelect","downloadPatient","pdf","patient","m","name","disease_type","created_at","format","toString","autoTable","headStyles","fillColor","font","fontStyle","columnStyles","valign","margin","top","columns","header","dataKey","body","downloadCloseContacts","contact_with","f","downloadHDR","num","obj","numColumns"],"sourceRoot":"src/views/admin","sources":["ReportGeneration.vue"],"sourcesContent":["<template>\n  <v-app>\n    <v-main class=\"accent\">\n      <div class=\"ma-16\">\n        <h2 class=\"primary--text font-weight-bold mt-12 mb-1\">\n          Generate Reports\n        </h2>\n        <h5 class=\"secondary--text\">\n          generating reports to downloaded pdf file\n        </h5>\n\n        <v-list class=\"mt-12\" nav>\n          <v-list-group :value=\"false\" no-action>\n            <template v-slot:activator>\n              <v-list-item-title>\n                <div\n                  class=\"font-weight-bold d-flex align-center justify-space-between\"\n                >\n                  <h4>Patient with Close Contacts</h4>\n                </div></v-list-item-title\n              >\n            </template>\n            <v-card flat width=\"auto\">\n              <div class=\"py-4 pl-n6 d-flex justify-space-between\">\n                <div class=\"d-flex justify-start width-div\">\n                  <v-menu\n                    v-model=\"menu\"\n                    :close-on-content-click=\"false\"\n                    :nudge-right=\"40\"\n                    transition=\"scale-transition\"\n                    offset-y\n                    min-width=\"auto\"\n                  >\n                    <template v-slot:activator=\"{ on, attrs }\">\n                      <v-text-field\n                        outlined\n                        dense\n                        filled\n                        v-model=\"date\"\n                        label=\"Pick Date\"\n                        prepend-icon=\"mdi-calendar\"\n                        readonly\n                        v-bind=\"attrs\"\n                        v-on=\"on\"\n                        class=\"ml-n4 mr-3\"\n                      ></v-text-field>\n                    </template>\n                    <v-date-picker\n                      v-model=\"date\"\n                      @input=\"handleDate\"\n                    ></v-date-picker>\n                  </v-menu>\n\n                  <v-select\n                    v-model=\"disease_id\"\n                    :items=\"diseases\"\n                    item-text=\"name\"\n                    item-value=\"id\"\n                    dense\n                    label=\"Disease Type\"\n                    outlined\n                    filled\n                    @input=\"handleSelect\"\n                  ></v-select>\n                </div>\n                <v-btn\n                  color=\"primary\"\n                  outlined\n                  class=\"text-capitalize font-weight-bold pt-5 pb-5\"\n                  @click=\"downloadPatient\"\n                  ><v-icon class=\"pr-3\">cloud_download</v-icon> Download</v-btn\n                >\n              </div>\n            </v-card>\n            <v-simple-table class=\"rounded-lg mb-6\">\n              <thead>\n                <tr class=\"text-center\">\n                  <th class=\"text-left black--text\">Patient Name</th>\n\n                  <th class=\"text-left black--text\">Disease Type</th>\n\n                  <th class=\"text-center black--text\">No. of Contacts</th>\n\n                  <th class=\"text-left black--text text-center\">Created At</th>\n\n                  <th class=\"text-left black--text text-center\">\n                    Check Contacts\n                  </th>\n                </tr>\n              </thead>\n\n              <tbody>\n                <tr\n                  class=\"text-center\"\n                  v-for=\"contact in contacts\"\n                  :key=\"contact.id\"\n                >\n                  <td\n                    class=\"text-capitalize text-left font-weight-bold primary--text\"\n                  >\n                    {{\n                      `${contact.user_account.first_name} ${contact.user_account?.middle_name} ${contact.user_account?.last_name}`\n                    }}\n                    <div class=\"secondary--text font-weight-thin\">\n                      {{ contact.user_account.classification[\"name\"] }}\n                    </div>\n                  </td>\n                  <td class=\"text-left\">{{ contact[\"disease\"][\"name\"] }}</td>\n                  <td class=\"text-center\">{{ contact[\"contacts\"].length }}</td>\n                  <td>{{ contact.created_at | filterDate }}</td>\n                  <td>\n                    <v-btn\n                      color=\"primary\"\n                      icon\n                      @click=\"\n                        $router.push(\n                          `/admin/manage/viewtrace/${contact.user_account.id}/${contact.id}`\n                        )\n                      \"\n                      ><v-icon>groups</v-icon></v-btn\n                    >\n                  </td>\n                </tr>\n              </tbody>\n            </v-simple-table>\n          </v-list-group>\n\n          <v-list-group :value=\"false\" no-action>\n            <template v-slot:activator>\n              <v-list-item-title>\n                <div\n                  class=\"font-weight-bold d-flex align-center justify-space-between\"\n                >\n                  <h4>Classified Close Contacts</h4>\n                </div></v-list-item-title\n              >\n            </template>\n            <v-card flat width=\"auto\">\n              <div class=\"py-4 pl-n6 d-flex justify-space-between\">\n                <div class=\"d-flex justify-start width-div\">\n                  <v-menu\n                    v-model=\"closeContact.menu\"\n                    :close-on-content-click=\"false\"\n                    :nudge-right=\"40\"\n                    transition=\"scale-transition\"\n                    offset-y\n                    min-width=\"auto\"\n                  >\n                    <template v-slot:activator=\"{ on, attrs }\">\n                      <v-text-field\n                        outlined\n                        dense\n                        filled\n                        v-model=\"closeContact.date\"\n                        label=\"Pick Date\"\n                        prepend-icon=\"mdi-calendar\"\n                        readonly\n                        v-bind=\"attrs\"\n                        v-on=\"on\"\n                        class=\"ml-n4 mr-3\"\n                      ></v-text-field>\n                    </template>\n                    <v-date-picker\n                      v-model=\"closeContact.date\"\n                      @input=\"handleCloseContactDate\"\n                    ></v-date-picker>\n                  </v-menu>\n\n                  <v-select\n                    v-model=\"closeContact.disease_id\"\n                    :items=\"diseases\"\n                    item-text=\"name\"\n                    item-value=\"id\"\n                    dense\n                    label=\"Disease Type\"\n                    outlined\n                    filled\n                    @input=\"handleCloseContactSelect\"\n                  ></v-select>\n                </div>\n                <v-btn\n                  color=\"primary\"\n                  outlined\n                  class=\"text-capitalize font-weight-bold pt-5 pb-5\"\n                  @click=\"downloadCloseContacts\"\n                  ><v-icon class=\"pr-3\">cloud_download</v-icon> Download</v-btn\n                >\n              </div>\n            </v-card>\n            <v-simple-table class=\"rounded-lg mb-6\">\n              <thead>\n                <tr class=\"text-center\">\n                  <th class=\"text-left black--text\">Name</th>\n\n                  <th class=\"text-left black--text\">Contact with</th>\n\n                  <th class=\"text-left black--text\">Disease Type</th>\n\n                  <th class=\"text-left black--text text-center\">Created At</th>\n                </tr>\n              </thead>\n\n              <tbody>\n                <tr\n                  class=\"text-center\"\n                  v-for=\"tagged in taggeds\"\n                  :key=\"tagged.id\"\n                >\n                  <td\n                    class=\"text-capitalize text-left font-weight-bold primary--text\"\n                  >\n                    {{\n                      `${tagged.user_account.first_name} ${tagged.user_account?.middle_name} ${tagged.user_account?.last_name}`\n                    }}\n                    <div class=\"secondary--text font-weight-thin\">\n                      {{ tagged.user_account.classification[\"name\"] }}\n                    </div>\n                  </td>\n                  <td class=\"text-left text-capitalize font-weight-bold\">\n                    {{\n                      `${tagged[\"contact_with\"]?.user_patient?.user_account?.first_name} ${tagged[\"contact_with\"]?.user_patient?.user_account?.middle_name}  ${tagged[\"contact_with\"]?.user_patient?.user_account?.last_name}`\n                    }}\n                    <div class=\"secondary--text font-weight-thin\">\n                      {{\n                        tagged[\"contact_with\"]?.user_patient?.user_account\n                          ?.classification?.name\n                      }}\n                    </div>\n                  </td>\n                  <td class=\"text-left\">{{ tagged.disease[\"name\"] }}</td>\n                  <td class=\"text-center\">\n                    {{ tagged.created_at | filterDate }}\n                  </td>\n                </tr>\n              </tbody>\n            </v-simple-table>\n          </v-list-group>\n\n          <!-- Follow Up Recoreds -->\n          <v-list-group :value=\"false\" no-action>\n            <template v-slot:activator>\n              <v-list-item-title>\n                <div\n                  class=\"font-weight-bold d-flex align-center justify-space-between\"\n                >\n                  <h4>Health Declaration Reponses</h4>\n                </div></v-list-item-title\n              >\n            </template>\n            <v-card flat>\n              <div class=\"py-4 pl-n6 d-flex justify-space-between\">\n                <div class=\"d-flex justify-start width-div\">\n                  <v-menu\n                    v-model=\"hdr['menu']\"\n                    :close-on-content-click=\"false\"\n                    :nudge-right=\"40\"\n                    transition=\"scale-transition\"\n                    offset-y\n                    min-width=\"auto\"\n                  >\n                    <template v-slot:activator=\"{ on, attrs }\">\n                      <v-text-field\n                        outlined\n                        dense\n                        filled\n                        v-model=\"hdr['date']\"\n                        label=\"Pick Date\"\n                        prepend-icon=\"mdi-calendar\"\n                        readonly\n                        v-bind=\"attrs\"\n                        v-on=\"on\"\n                        class=\"ml-n4 mr-3\"\n                      ></v-text-field>\n                    </template>\n                    <v-date-picker\n                      v-model=\"hdr['date']\"\n                      @input=\"handleHdrDate\"\n                    ></v-date-picker>\n                  </v-menu>\n                </div>\n                <v-btn\n                  color=\"primary\"\n                  outlined\n                  class=\"text-capitalize font-weight-bold pt-5 pb-5\"\n                  @click=\"downloadHDR\"\n                  ><v-icon class=\"pr-3\">cloud_download</v-icon> Download</v-btn\n                >\n              </div>\n            </v-card>\n            <v-simple-table class=\"rounded-lg mb-6\">\n              <thead>\n                <tr class=\"text-center\">\n                  <th class=\"text-left black--text\">Name</th>\n\n                  <th class=\"text-left black--text text-center\">Date</th>\n\n                  <th class=\"text-left black--text text-center\">Time</th>\n\n                  <th class=\"text-left black--text text-center\">\n                    Check Response\n                  </th>\n                </tr>\n              </thead>\n\n              <tbody>\n                <tr\n                  class=\"text-center\"\n                  v-for=\"record in records\"\n                  :key=\"record.id\"\n                >\n                  <td\n                    class=\"text-left font-weight-bold primary--text text-capitalize\"\n                  >\n                    {{\n                      `${record.user_account[\"first_name\"]} ${record.user_account?.middle_name} ${record.user_account?.last_name}`\n                    }}\n                    <div class=\"font-weight-thin secondary--text\">\n                      {{ record[\"user_account\"][\"classification\"][\"name\"] }}\n                    </div>\n                  </td>\n                  <td>{{ record.created_at | filterDate }}</td>\n                  <td>{{ record.created_at | filterTime }}</td>\n                  <td>\n                    <v-btn color=\"primary\" icon\n                    @click=\"handleFormDialog(record.answers)\"\n                      ><v-icon>description</v-icon></v-btn\n                    >\n                  </td>\n                </tr>\n              </tbody>\n            </v-simple-table>\n          </v-list-group>\n        </v-list>\n      </div>\n    </v-main>\n    <!-- Form Dialog -->\n    <v-dialog v-model=\"form_dialog\" @click:outside=\"form_dialog = false\" width=\"540\">\n      <v-card v-for=\"(response,index) in form_answers\" :key=\"response.id\" tile>\n        <v-card-title primary-title class=\"text-justify\">\n          <h6>{{ `${index + 1}. ${response.question.question}` }}</h6>\n        </v-card-title>\n\n        <v-card-text>\n          <ul v-if=\"response.question.sub_question\" class=\"mt-n4\">\n            <li v-for=\"(q,index) in handleQuestion(response.question.sub_question)\" :key=\"index\">\n              <h4>{{q}}</h4>          \n            </li>\n          </ul>\n\n          <div class=\"mt-4\">\n            <v-text-field outlined readonly label=\"Answer\" :value=\"response.answer == 1 ? `True` : `False`\"></v-text-field>\n          </div>\n        </v-card-text>\n      </v-card>\n    </v-dialog>\n  </v-app>\n</template>\n\n<script>\nimport { mapState } from \"vuex\";\nimport moment from \"moment\";\nimport jspdf from \"jspdf\";\nimport autoTable from \"jspdf-autotable\";\nexport default {\n  mounted() {\n    this.$store.dispatch(\"generates/getPatient\");\n    this.$store.dispatch(\"disease/getData\");\n    this.$store.dispatch(\"generates/submittedResponse\");\n    this.$store.dispatch(\"generates/getTaggeds\");\n  },\n  filters: {\n    filterDate(val) {\n      return moment(val).format(\"MMM. DD, YYYY\").toString();\n    },\n    filterTime(val) {\n      return moment(val).format(\"hh:mm a\").toString();\n    },\n  },\n  computed: {\n    ...mapState({\n      diseases: (state) => state.disease.all.data,\n      contacts: (state) => state.generates.all.data,\n      records: (state) => state.generates.submit.data,\n      taggeds: (state) => state.generates.taggeds.data,\n    }),\n  },\n  data() {\n    return {\n      form_answers:[],\n      form_dialog:false,\n      disease_id: null,\n      date: \"\",\n      closeContact: {\n        disease_id: null,\n        date: \"\",\n        menu: false,\n      },\n      hdr: {\n        date: \"\",\n        menu: false,\n      },\n      page: 1,\n      menu: false,\n    };\n  },\n  methods: {\n    handleQuestion(data){\n      console.log(data.split(\",\"));\n      if(data.trim()){\n        const arr = data.split(\",\")\n        return arr\n      }\n      return []\n    },\n    handleFormDialog(data){\n      this.form_answers = data\n      this.form_dialog =  true\n    },\n    handleDate(data) {\n      console.log(data);\n      this.$store.dispatch(\"generates/getDatePatient\", { date: data });\n      this.menu = false;\n    },\n    handleCloseContactDate(data) {\n      console.log(data);\n      this.$store.dispatch(\"generates/getDateTaggeds\", { date: data });\n      this.closeContact.menu = false;\n    },\n    handleHdrDate(data) {\n      console.log(data);\n      this.$store.dispatch(\"generates/dateResponse\", { date: data });\n      this.hdr[\"menu\"] = false;\n    },\n    handleCloseContactSelect(data) {\n      console.log(\"cc\", data);\n      if (this.closeContact[\"date\"]) {\n        this.$store.dispatch(\"generates/getDateTaggeds\", {\n          date: this.closeContact.date,\n          disease_id: data,\n        });\n        return;\n      }\n      this.$store.dispatch(\"generates/getDateTaggeds\", { disease_id: data });\n    },\n    handleSelect(data) {\n      console.log(data);\n      if (this.date) {\n        this.$store.dispatch(\"generates/getDatePatient\", {\n          date: this.date,\n          disease_id: data,\n        });\n        return;\n      }\n      this.$store.dispatch(\"generates/getDatePatient\", { disease_id: data });\n    },\n    // Generete Pdf Buttons\n    downloadPatient() {\n      const pdf = new jspdf();\n      const msg = \"Generated Reports\";\n      const content = \"Patient with Close Contacts\";\n\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 15, msg);\n\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 22, content);\n\n      // let crement = 0\n\n      for (const i of this.contacts) {\n        // crement +=1\n        // pdf.setFontSize(11);\n        // pdf.setFont(\"courier\");\n        // pdf.text(15 , 38 + crement, `${i.user_account.first_name.toUpperCase()} ${i.user_account?.middle_name ? i.user_account?.middle_name.toUpperCase() : \" \"} ${i.user_account?.last_name.toUpperCase()}`);\n\n        // pdf.setFontSize(11);\n        // pdf.setFont(\"courier\");\n        // pdf.text(15 , 40 + crement, `Created At: ${moment(i.created_at).format(\"MMM. DD, YYYY\").toString()}`);\n        // pdf.text(120, 40 + crement, `Disease Type : ${i.disease.name}`);\n\n        const newMap = i.contacts.map((m) => {\n          console.log(\"enter\", m);\n          return {\n            patient: `${m.user_patient.user_account?.first_name.toUpperCase()} ${m.user_patient.user_account?.middle_name.toUpperCase()} ${m.user_patient.user_account?.last_name.toUpperCase()} \\n ${\n              m.user_patient.user_account.classification?.name\n            }`,\n            name: `${m.user_tagged.user_account.first_name.toUpperCase()} ${\n              m.user_tagged.user_account?.middle_name\n                ? m.user_tagged.user_account.middle_name.toUpperCase()\n                : \" \"\n            } ${m.user_tagged.user_account.last_name.toUpperCase()} \\n ${\n              m.user_tagged.user_account.classification.name\n            }`,\n            disease_type: m.user_tagged.disease.name,\n            created_at: moment(m.user_tagged.created_at)\n              .format(\"MMM. DD, YYYY\")\n              .toString(),\n          };\n        });\n\n        autoTable(pdf, {\n          headStyles: {\n            fillColor: \"#141E61\",\n            font: \"courier\",\n            fontStyle: \"bold\",\n          },\n          columnStyles: {\n            name: { font: \"courier\", valign: \"middle\" },\n            disease_type: { font: \"courier\" },\n            created_at: { font: \"courier\" },\n          },\n          margin: {\n            top: 45,\n          },\n          columns: [\n            { header: \"Patient Name\", dataKey: \"patient\" },\n            { header: \"Close Contacted\", dataKey: \"name\" },\n            { header: \"Disease Type\", dataKey: \"disease_type\" },\n            { header: \"Created At\", dataKey: \"created_at\" },\n          ],\n          body: newMap,\n        });\n      }\n\n      if (this.date.trim() == \"\" && this.disease_id) {\n        const find = this.diseases.find((f) => f.id == this.disease_id);\n        pdf.save(`${find.name}-patient-with-close-contacts.pdf`);\n      } else if (this.date && !this.disease_id) {\n        pdf.save(`${this.date}-patient-with-close-contacts.pdf`);\n      } else if (this.date && this.disease_id) {\n        const find = this.diseases.find((f) => f.id == this.disease_id);\n        pdf.save(`${this.date}-${find.name}-patient-with-close-contacts.pdf`);\n      } else {\n        pdf.save(`all-patient-with-close-contacts.pdf`);\n      }\n    },\n\n    downloadCloseContacts() {\n      const newMap = this.taggeds.map((m) => {\n        return {\n          name: `${m.user_account.first_name.toUpperCase()} ${\n            m.user_account?.middle_name\n              ? m.user_account.middle_name.toUpperCase()\n              : \" \"\n          } ${m.user_account.last_name.toUpperCase()} \\t ${\n            m.user_account.classification.name\n          }`,\n          contact_with: `${m.contact_with?.user_patient?.user_account.first_name.toUpperCase()} ${\n            m.contact_with?.user_patient?.user_account?.middle_name\n              ? m.contact_with?.user_patient?.user_account.middle_name.toUpperCase()\n              : \" \"\n          } ${m.contact_with?.user_patient?.user_account.last_name.toUpperCase()} \\t ${\n            m.user_account.classification.name\n          }`,\n          disease_type: m.disease.name,\n          created_at: moment(m.created_at).format(\"MMM. DD, YYYY\").toString(),\n        };\n      });\n\n      const pdf = new jspdf();\n      const msg = \"Generated Reports\";\n      const content = \"Classified Close Contacts\";\n\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 15, msg);\n\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 22, content);\n\n      autoTable(pdf, {\n        headStyles: { fillColor: \"#141E61\" },\n        margin: {\n          top: 45,\n        },\n        columns: [\n          { header: \"Name\", dataKey: \"name\" },\n          { header: \"Contact With\", dataKey: \"contact_with\" },\n          { header: \"Disease Type\", dataKey: \"disease_type\" },\n          { header: \"Created At\", dataKey: \"created_at\" },\n        ],\n        body: newMap,\n      });\n\n      if (this.closeContact.date.trim() == \"\" && this.closeContact.disease_id) {\n        const find = this.diseases.find(\n          (f) => f.id == this.closeContact.disease_id\n        );\n        pdf.save(`${find.name}-classified-close-contacts.pdf`);\n      } else if (this.closeContact.date && !this.closeContact.disease_id) {\n        pdf.save(`${this.closeContact.date}-classified-close-contacts.pdf`);\n      } else if (this.closeContact[\"date\"] && this.closeContact.disease_id) {\n        const find = this.diseases.find(\n          (f) => f.id == this.closeContact.disease_id\n        );\n        pdf.save(\n          `${this.closeContact[\"date\"]}-${find.name}-classified-close-contacts.pdf`\n        );\n      } else {\n        pdf.save(`all-classified-close-contacts.pdf`);\n      }\n    },\n    downloadHDR() {\n      const newMap = this.records.map((m) => {\n        let num = 0;\n        const obj = {};\n\n        for (const key of m.answers) {\n          num += 1;\n          obj[`Question No. ${num}`] = key.answer ? \"True\" : \"False\";\n        }\n        obj[\"time\"] = moment(m.created_at).format(\"hh:mm a\").toString();\n        obj[\"date\"] = moment(m.created_at).format(\"MMM. DD, YYYY\").toString();\n        obj[\"name\"] = `${m.user_account.first_name.toUpperCase()} ${\n          m.user_account?.middle_name\n            ? m.user_account.middle_name.toUpperCase()\n            : \" \"\n        } ${m.user_account.last_name.toUpperCase()}`;\n        return obj;\n      });\n\n      let numColumns = -1;\n      const columns = [];\n\n      if (newMap.length) {\n        for (const key of Object.keys(newMap[0]).reverse()) {\n          numColumns += 1;\n          columns[numColumns] = {\n            header: key.toString().toUpperCase(),\n            dataKey: key,\n          };\n        }\n      }\n\n      const pdf = new jspdf();\n      const msg = \"Generated Reports\";\n      const content = \"Health Declaration Responses\";\n\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 15, msg);\n\n      pdf.setFontSize(16);\n      pdf.setFont(\"helvetica\");\n      pdf.text(15, 22, content);\n\n      autoTable(pdf, {\n        headStyles: { fillColor: \"#141E61\" },\n        margin: {\n          top: 45,\n        },\n        columns: columns,\n        body: newMap.reverse(),\n      });\n\n      if (this.hdr.date.trim() == \"\") {\n        pdf.save(\"All-HDR.pdf\");\n        return;\n      }\n\n      pdf.save(`${this.hdr.date}-HD.pdf`);\n    },\n  },\n};\n</script>\n\n<style scoped>\n.bg {\n  background-color: #f8f0f0;\n}\n.adj {\n  width: 280px;\n}\n.width-div {\n  width: 460px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}