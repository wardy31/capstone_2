{"ast":null,"code":"import * as faceapi from 'face-api.js';\nexport default {\n  namespaced: true,\n  state: () => ({\n    loading: false,\n    loaded: false\n  }),\n  mutations: {\n    loading(state) {\n      state.loading = true;\n    },\n    load(state) {\n      state.loading = false;\n      state.loaded = true;\n    }\n  },\n  actions: {\n    async load({\n      commit,\n      state\n    }) {\n      if (!state.loading && !state.loaded) {\n        commit('loading');\n        return Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri('/models'), faceapi.nets.faceRecognitionNet.loadFromUri('/models'), faceapi.nets.faceLandmark68Net.loadFromUri('/models'), faceapi.nets.ssdMobilenetv1.loadFromUri('/models'), faceapi.nets.faceExpressionNet.loadFromUri('/models')]).then(() => {\n          commit('load');\n          console.log(\"Loaded\");\n          console.log(faceapi.nets);\n        });\n      }\n    },\n    async run() {\n      const videoEl = document.getElementById('inputVideo');\n      navigator.getUserMedia({\n        video: {}\n      }, stream => videoEl.srcObject = stream, err => console.error(err));\n      videoEl.addEventListener('play', async () => {\n        //const canvas = faceapi.createCanvasFromMedia(videoEl)\n        const canvas = document.getElementById('canvas');\n        const displaySize = {\n          width: videoEl.width,\n          height: videoEl.height\n        };\n        faceapi.matchDimensions(canvas, displaySize);\n        setInterval(async () => {\n          const detections = await faceapi.detectAllFaces(videoEl, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceExpressions();\n          console.log(detections);\n          const resizedDetections = faceapi.resizeResults(detections, displaySize);\n          canvas.getContext('2d').clearRect(0, 0, canvas.width, canvas.height);\n          faceapi.draw.drawDetections(canvas, resizedDetections);\n          faceapi.draw.drawFaceLandmarks(canvas, resizedDetections);\n          faceapi.draw.drawFaceExpressions(canvas, resizedDetections);\n        }, 100);\n      });\n    }\n  },\n  getters: {}\n};","map":{"version":3,"names":["faceapi","namespaced","state","loading","loaded","mutations","load","actions","commit","Promise","all","nets","tinyFaceDetector","loadFromUri","faceRecognitionNet","faceLandmark68Net","ssdMobilenetv1","faceExpressionNet","then","console","log","run","videoEl","document","getElementById","navigator","getUserMedia","video","stream","srcObject","err","error","addEventListener","canvas","displaySize","width","height","matchDimensions","setInterval","detections","detectAllFaces","TinyFaceDetectorOptions","withFaceLandmarks","withFaceExpressions","resizedDetections","resizeResults","getContext","clearRect","draw","drawDetections","drawFaceLandmarks","drawFaceExpressions","getters"],"sources":["/home/wardy/Desktop/capstone/fe/src/store/modules/face.js"],"sourcesContent":["import * as faceapi from 'face-api.js'\n\nexport default {\n    namespaced: true,\n    state: () => ({\n        loading: false,\n        loaded: false\n    }),\n    mutations: {\n        loading(state){\n            state.loading = true\n        },\n        load(state){\n            state.loading = false\n            state.loaded = true\n        }\n    },\n    actions: {\n        async load({commit, state}){\n            if (!state.loading && !state.loaded) {\n                commit('loading')\n                return Promise.all([\n                    faceapi.nets.tinyFaceDetector.loadFromUri('/models'),\n                    faceapi.nets.faceRecognitionNet.loadFromUri('/models'),\n                    faceapi.nets.faceLandmark68Net.loadFromUri('/models'),\n                    faceapi.nets.ssdMobilenetv1.loadFromUri('/models'),\n                    faceapi.nets.faceExpressionNet.loadFromUri('/models')\n                ])\n                .then(() => {\n                    commit('load')\n                    console.log(\"Loaded\")\n                    console.log(faceapi.nets)\n                })\n            }\n    \n        },\n        async run(){\n           const videoEl = document.getElementById('inputVideo')\n           \n            navigator.getUserMedia(\n                { video: {} },\n                stream => videoEl.srcObject = stream,\n                err => console.error(err)\n            ) \n            \n            videoEl.addEventListener('play', async () => {\n                //const canvas = faceapi.createCanvasFromMedia(videoEl)\n                const canvas = document.getElementById('canvas')\n                const displaySize = {width: videoEl.width, height: videoEl.height}\n                faceapi.matchDimensions(canvas,displaySize)\n                setInterval(async () => {\n                    const detections = await faceapi.detectAllFaces(videoEl, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceExpressions()\n                    console.log(detections)\n\n                    const resizedDetections = faceapi.resizeResults(detections,displaySize)\n                    canvas.getContext('2d').clearRect(0,0,canvas.width,canvas.height)\n                    faceapi.draw.drawDetections(canvas, resizedDetections)\n                    faceapi.draw.drawFaceLandmarks(canvas, resizedDetections)\n                     faceapi.draw.drawFaceExpressions(canvas, resizedDetections)\n                },100)\n            })\n\n        }\n    },\n    getters: {\n\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}